import{M as b,F as c,E as e}from"./vendor-AZjfysqh.js";import{u as v,b as y}from"./index-CcBKZM2H.js";import"./router-CieCW4vl.js";function R(){const{users:x,listAssignedHrQueries:l,respondHrQuery:j}=v(),{addNotification:h}=y(),u=b(),[g,a]=c.useState([]),[d,m]=c.useState("all");c.useEffect(()=>{const s=async()=>{try{const r=await l();a(Array.isArray(r)?r:[])}catch{a([])}};s();const t=setInterval(s,1e4);return()=>clearInterval(t)},[l]);const p=s=>{const t=(x||[]).find(r=>(r.email||"").toLowerCase()===String(s||"").toLowerCase());return t?`${t.firstName||""} ${t.lastName||""}`.trim()||t.username||t.email:s},f=s=>{switch(s){case"submitted":return"#ffc107";case"in-progress":return"#007bff";case"resolved":return"#28a745";case"closed":return"#6c757d";default:return"#6c757d"}},i=g.filter(s=>d==="all"?!0:s.status===d),o=async(s,t,r="")=>{try{await j(s,{status:t,response:r});const n=await l();a(Array.isArray(n)?n:[]),h({title:"HR Query",message:`#${s} ${t}`,type:"success",ttl:3e3})}catch(n){h({title:"HR Query",message:(n==null?void 0:n.message)||"Failed to update query",type:"error",ttl:5e3})}};return e.jsxs("div",{className:"dashboard fade-in",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("div",{children:e.jsx("h2",{children:"ðŸ“ Solve HR Queries"})}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("label",{style:{fontSize:14},children:"Filter:"}),e.jsxs("select",{value:d,onChange:s=>m(s.target.value),children:[e.jsx("option",{value:"all",children:"All Queries"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"resolved",children:"Resolved"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("button",{className:"btn-outline",onClick:()=>u("/hr/lcrm"),children:"â† Back to ICRM"})]})]}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"one-on-one-table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Query ID"}),e.jsx("th",{children:"Employee"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Urgency"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{style:{width:200},children:"Actions"})]})}),e.jsx("tbody",{children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{textAlign:"center"},children:"No HR queries found."})}):i.map(s=>e.jsxs("tr",{children:[e.jsxs("td",{children:["#",s.id]}),e.jsx("td",{children:p(s.employeeEmail)}),e.jsx("td",{children:e.jsx("span",{className:"role-badge",children:s.category})}),e.jsx("td",{children:s.subject}),e.jsx("td",{style:{color:s.urgency==="urgent"?"#dc3545":s.urgency==="high"?"#fd7e14":"#6c757d",fontWeight:s.urgency==="urgent"||s.urgency==="high"?"bold":"normal"},children:s.urgency}),e.jsx("td",{children:e.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:f(s.status),color:"white"},children:s.status.toUpperCase()})}),e.jsx("td",{children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{style:{display:"flex",gap:4,justifyContent:"center"},children:[s.status==="submitted"&&e.jsx("button",{className:"btn-primary",style:{padding:"4px 8px",fontSize:12},onClick:()=>o(s.id,"in-progress"),children:"Start"}),s.status==="in-progress"&&e.jsx("button",{className:"btn-primary",style:{padding:"4px 8px",fontSize:12},onClick:()=>{const t=prompt("Enter response for the employee:");t&&o(s.id,"resolved",t)},children:"Resolve"}),s.status==="resolved"&&e.jsx("button",{className:"btn-outline",style:{padding:"4px 8px",fontSize:12},onClick:()=>o(s.id,"closed"),children:"Close"})]})]},s.id))})]})}),i.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("h3",{children:"Query Details"}),i.map(s=>e.jsxs("div",{className:"dashboard-card",style:{marginBottom:12,padding:"14px",textAlign:"left"},children:[e.jsxs("h4",{children:["#",s.id," - ",s.subject]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Employee:"})," ",p(s.employeeEmail)," (",s.employeeEmail,")"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",s.description]}),s.response&&e.jsxs("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#e8f5e8",borderRadius:"4px",borderLeft:"4px solid #28a745"},children:[e.jsx("strong",{children:"HR Response:"}),e.jsx("p",{style:{margin:"5px 0 0 0"},children:s.response})]})]},`detail-${s.id}`))]})]})}export{R as default};
