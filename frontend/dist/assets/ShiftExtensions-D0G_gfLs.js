import{F as i,E as e}from"./vendor-AZjfysqh.js";import{u as A}from"./index-CcBKZM2H.js";import"./router-CieCW4vl.js";function K(){const{listAssignedShiftExtensions:E,updateShiftExtensionStatus:v}=A(),[w,u]=i.useState(!0),[p,F]=i.useState([]),[a,S]=i.useState("pending"),[y,b]=i.useState(""),[x,B]=i.useState(""),c=async()=>{try{u(!0),b("");const t=await E(a);F(Array.isArray(t)?t:[])}catch(t){b((t==null?void 0:t.message)||"Failed to load shift extensions")}finally{u(!1)}};i.useEffect(()=>{c();const t=()=>c();return window.addEventListener("erp-shift-requests-updated",t),()=>window.removeEventListener("erp-shift-requests-updated",t)},[a]);const j=i.useMemo(()=>{const t=x.trim().toLowerCase();return t?p.filter(s=>String(s.employeeEmail||"").toLowerCase().includes(t)||String(s.shiftType||"").toLowerCase().includes(t)||String(s.status||"").toLowerCase().includes(t)):p},[p,x]),f=async(t,s,n)=>{const r=String(n||"").toLowerCase();if(!(r==="approved"||r==="rejected"))try{await v(t,s),await c()}catch(o){alert((o==null?void 0:o.message)||"Action failed")}},C=({status:t})=>{const s=String(t||"").toLowerCase(),n=s==="approved"?{bg:"#ECFDF5",text:"#065F46",bd:"#10B981"}:s==="rejected"?{bg:"#FEF2F2",text:"#991B1B",bd:"#EF4444"}:{bg:"#EFF6FF",text:"#1E40AF",bd:"#3B82F6"};return e.jsx("span",{style:{display:"inline-block",padding:"4px 10px",borderRadius:999,background:n.bg,color:n.text,border:`1px solid ${n.bd}`,fontWeight:600,fontSize:12},children:String(t).charAt(0).toUpperCase()+String(t).slice(1)})},m=({kind:t="approve",disabled:s,onClick:n,children:r})=>{const h=t==="approve"?{bg:"#10B981",bgH:"#059669"}:{bg:"#EF4444",bgH:"#DC2626"};return e.jsx("button",{onClick:n,disabled:s,style:{cursor:s?"not-allowed":"pointer",opacity:s?.6:1,background:h.bg,color:"white",border:"none",padding:"8px 12px",borderRadius:8,fontWeight:600,transition:"all .15s ease"},onMouseOver:g=>!s&&(g.currentTarget.style.background=h.bgH),onMouseOut:g=>!s&&(g.currentTarget.style.background=h.bg),children:r})};return e.jsxs("div",{style:k,children:[e.jsxs("div",{style:R,children:[e.jsx("div",{children:e.jsx("h2",{style:W,children:"Shift Extension Requests"})}),e.jsxs("div",{style:L,children:[e.jsx("div",{style:I,children:["pending","approved","rejected",""].map((t,s)=>e.jsx("button",{onClick:()=>S(t),style:{...T,...a===t?q:{}},children:t?t.charAt(0).toUpperCase()+t.slice(1):"All"},s))}),e.jsxs("div",{style:D,children:[e.jsx("input",{value:x,onChange:t=>B(t.target.value),placeholder:"Search employee, status...",style:z}),e.jsx("button",{onClick:c,style:H,children:"Refresh"})]})]})]}),y&&e.jsx("div",{style:O,children:y}),e.jsx("div",{style:M,children:w?e.jsx("div",{style:X,children:"Loading requests…"}):j.length===0?e.jsxs("div",{style:N,children:[e.jsx("div",{style:Q,children:"⏱️"}),e.jsx("div",{style:{fontWeight:700,fontSize:18,marginTop:4},children:"No requests found"}),e.jsx("div",{style:{color:"#6B7280",marginTop:2},children:"Try changing the filter or refreshing."})]}):e.jsx("div",{style:{overflowX:"auto"},children:(()=>{const t=a==="pending";return e.jsxs("table",{style:U,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:d,children:"Employee ID"}),e.jsx("th",{style:d,children:"Employee"}),e.jsx("th",{style:d,children:"Shift"}),e.jsx("th",{style:d,children:"Status"}),e.jsx("th",{style:d,children:"Requested"}),t&&e.jsx("th",{style:d,children:"Actions"})]})}),e.jsx("tbody",{children:j.map((s,n)=>e.jsxs("tr",{style:{background:n%2?"#FCFCFD":"white"},children:[e.jsx("td",{style:l,children:s.employeeId||"-"}),e.jsx("td",{style:l,children:e.jsx("div",{style:{fontWeight:600},children:s.employeeEmail})}),e.jsx("td",{style:l,children:s.shiftType||"-"}),e.jsx("td",{style:l,children:e.jsx(C,{status:s.status})}),e.jsx("td",{style:l,children:s.createdAt?new Date(s.createdAt).toLocaleString():"-"}),t&&e.jsx("td",{style:{...l,whiteSpace:"nowrap"},children:(()=>{const r=String(s.status).toLowerCase(),o=r==="approved"||r==="rejected";return e.jsxs(e.Fragment,{children:[e.jsx(m,{kind:"approve",disabled:o,onClick:()=>f(s.id,"approved",s.status),children:"Approve"}),e.jsx("span",{style:{display:"inline-block",width:8}}),e.jsx(m,{kind:"reject",disabled:o,onClick:()=>f(s.id,"rejected",s.status),children:"Reject"})]})})()})]},s.id))})]})})()})})]})}const k={padding:20,maxWidth:1200,margin:"0 auto"},R={display:"flex",justifyContent:"space-between",alignItems:"flex-end",gap:16,marginBottom:16},W={margin:0,fontSize:28,fontWeight:800,letterSpacing:-.3},L={display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},I={display:"inline-flex",padding:4,background:"#F3F4F6",borderRadius:12,border:"1px solid #E5E7EB"},T={border:"none",background:"transparent",padding:"6px 12px",borderRadius:8,fontWeight:600,color:"#374151",cursor:"pointer"},q={background:"white",boxShadow:"0 1px 0 rgba(0,0,0,.04)",color:"#111827",border:"1px solid #E5E7EB"},D={display:"flex",gap:8},z={padding:"8px 10px",borderRadius:8,border:"1px solid #E5E7EB",minWidth:260},H={padding:"8px 12px",borderRadius:8,border:"1px solid #E5E7EB",background:"white",cursor:"pointer",fontWeight:600},M={background:"white",border:"1px solid #E5E7EB",borderRadius:12,padding:12},U={width:"100%",borderCollapse:"separate",borderSpacing:0},d={textAlign:"left",padding:"12px 10px",borderBottom:"1px solid #E5E7EB",fontSize:12,letterSpacing:.3,color:"#6B7280",textTransform:"uppercase"},l={padding:"12px 10px",borderBottom:"1px solid #F3F4F6",color:"#111827"},O={background:"#FEF2F2",color:"#991B1B",border:"1px solid #FECACA",padding:10,borderRadius:8,marginBottom:12},N={display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"48px 12px",color:"#6B7280"},Q={fontSize:42,opacity:.8},X={padding:24,color:"#6B7280"};export{K as default};
