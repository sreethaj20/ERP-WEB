import{M,F as r,E as e}from"./vendor-AZjfysqh.js";import{f as E}from"./date-DAJMpUuB.js";import{u as G,g as J}from"./index-CcBKZM2H.js";import"./router-CieCW4vl.js";function X(){const{users:m,updateUser:C,addUser:L,removeUser:w,currentUser:i}=G(),y=M(),[c,I]=r.useState([]),[A,p]=r.useState(!1),[u,x]=r.useState(-1),[R,F]=r.useState(null),[P,$]=r.useState([]),[H,z]=r.useState(""),[W,Y]=r.useState(!1),[n,h]=r.useState({name:"",firstName:"",lastName:"",email:"",password:"",role:"employee",status:"Active",department:"",designation:"",teamLeadEmail:"",dateOfJoining:"",empId:"",bloodGroup:"",dateOfBirth:"",coreEducation:""}),g=J(i||{}),O=((i==null?void 0:i.role)||"").toLowerCase()==="admin";((i==null?void 0:i.role)||"").toLowerCase();const j=!O&&g==="teamlead",N=(t="")=>String(t||"").trim().replace(/\s+/g," ").toLowerCase(),b=t=>{const a=N(t);return a.replace(/\s+/g,"").includes("hrbplead")||a.includes("hrbp")&&a.includes("lead")},B=b((i==null?void 0:i.designation)||(i==null?void 0:i.position)||"");r.useEffect(()=>{const t=m.filter(s=>(s.role||"").toLowerCase()==="employee"),d=B?t.filter(s=>{const l=N((s==null?void 0:s.designation)||(s==null?void 0:s.position)||"");return!l||b(l)?!1:l.includes("hrbp")||l.includes("hr recruiter")||l.includes("it recruiter")||l.includes("developer")}):g==="teamlead"?t.filter(s=>(s.teamLeadEmail||"").toLowerCase()===((i==null?void 0:i.email)||"").toLowerCase()):t;I(d)},[m,i,g]);const o=t=>{h({...n,[t.target.name]:t.target.value})},D=t=>{var d;t.preventDefault();let a={...n};if(!a.firstName&&!a.lastName&&(a.name||"").trim()){const[s,...l]=(a.name||"").trim().split(" ");a.firstName=s||"",a.lastName=l.join(" ")}if(a.password||(a.password="Password@001"),(a.role||"employee").toLowerCase()==="employee"&&j&&(a.teamLeadEmail=a.teamLeadEmail||(i==null?void 0:i.email)||""),u>=0){const s=(d=c[u])==null?void 0:d.email;let l=m.findIndex(f=>f.email===s);l<0&&(l=m.findIndex(f=>f.email===(a.email||""))),l>=0?(C(l,a),alert("âœ… Employee updated")):alert("âš ï¸ Could not locate the user to update. Please try again."),x(-1)}else L(a),alert("âœ… Employee added");v()},v=()=>{h({name:"",firstName:"",lastName:"",email:"",password:"",role:"employee",status:"Active",department:"",designation:"",teamLeadEmail:"",dateOfJoining:"",empId:"",bloodGroup:"",dateOfBirth:"",coreEducation:""}),p(!1)},S=t=>{const a=c[t];h({name:`${a.firstName||""} ${a.lastName||""}`.trim(),firstName:a.firstName||"",lastName:a.lastName||"",email:a.email||"",password:a.password||"",role:a.role||"employee",status:a.status||"Active",department:a.department||"",designation:a.designation||a.position||"",teamLeadEmail:a.teamLeadEmail||"",dateOfJoining:(a.dateOfJoining||"").slice(0,10),empId:a.empId||"",bloodGroup:a.bloodGroup||"",dateOfBirth:(a.dateOfBirth||"").slice(0,10),coreEducation:a.coreEducation||""}),x(t),p(!0)},T=t=>{if(window.confirm("Are you sure you want to remove this team member?")){const a=c[t],d=m.findIndex(s=>s.email===a.email);w(d)}},k=()=>{(i==null?void 0:i.role)==="admin"?y("/admin/dashboard"):y("/")};return e.jsxs("div",{className:"dashboard fade-in",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("div",{children:e.jsx("h2",{children:"ðŸ‘¥ Team Management"})}),e.jsx("button",{className:"btn-outline back-to-dashboard",onClick:k,children:"â† Back to Home"})]}),e.jsxs("div",{className:"dashboard-actions",children:[e.jsx("button",{className:"btn-primary",onClick:()=>{x(-1),h({name:"",firstName:"",lastName:"",email:"",password:"",role:"employee",status:"Active",department:"",designation:"",teamLeadEmail:j&&(i==null?void 0:i.email)||"",dateOfJoining:"",empId:"",bloodGroup:"",dateOfBirth:"",coreEducation:""}),p(!0)},children:"Add Team Member"}),(i==null?void 0:i.role)==="admin"&&e.jsx("button",{className:"btn-outline",style:{marginLeft:8},onClick:()=>{x(-1),h({name:"",firstName:"",lastName:"",email:"",password:"",role:"teamlead",status:"Active",department:"",designation:"Team Lead",teamLeadEmail:"",dateOfJoining:"",empId:"",bloodGroup:"",dateOfBirth:"",coreEducation:""}),p(!0)},children:"Add Team Lead"})]}),!1,A&&e.jsx("div",{className:"form-overlay",style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.35)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{className:"form-container",style:{maxWidth:860,width:"92%",background:"#fff",borderRadius:12,boxShadow:"0 12px 28px rgba(0,0,0,0.12)",padding:20,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #eef2ff 0%, #f0fdf4 100%)",padding:"12px 14px",borderRadius:10,marginBottom:12,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0},children:u>=0?"Edit Team Member":"Add New Team Member"}),e.jsx("button",{type:"button",className:"btn-outline",onClick:()=>p(!1),children:"âœ•"})]}),e.jsxs("form",{onSubmit:D,children:[e.jsxs("div",{className:"grid-3-cols",style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12},children:[e.jsx("input",{type:"text",placeholder:"EMP ID",name:"empId",value:n.empId,onChange:o}),e.jsx("input",{type:"text",placeholder:"First Name",name:"firstName",value:n.firstName,onChange:o}),e.jsx("input",{type:"text",placeholder:"Last Name",name:"lastName",value:n.lastName,onChange:o}),e.jsx("input",{type:"text",placeholder:"Emp Name",name:"name",value:n.name,onChange:o}),e.jsx("input",{type:"email",placeholder:"Emp Email",name:"email",value:n.email,onChange:o}),e.jsx("input",{type:"text",placeholder:"Blood Group (e.g., O+ / A-)",name:"bloodGroup",value:n.bloodGroup,onChange:o}),e.jsx("input",{type:"date",name:"dateOfBirth",value:n.dateOfBirth,onChange:o}),e.jsx("input",{type:"text",placeholder:"Department",name:"department",value:n.department,onChange:o}),e.jsx("input",{type:"text",placeholder:"Designation",name:"designation",value:n.designation,onChange:o}),e.jsxs("select",{name:"status",value:n.status,onChange:o,children:[e.jsx("option",{value:"Active",children:"Active"}),e.jsx("option",{value:"Inactive",children:"Inactive"})]}),e.jsx("input",{type:"text",placeholder:"Employee Core Education (e.g., B.Tech)",name:"coreEducation",value:n.coreEducation,onChange:o}),e.jsx("input",{type:"date",name:"dateOfJoining",value:n.dateOfJoining,onChange:o}),!j&&e.jsxs("select",{name:"teamLeadEmail",value:n.teamLeadEmail,onChange:o,style:{gridColumn:"span 3"},children:[e.jsx("option",{value:"",children:"Select Reporting To"}),m.filter(t=>{const a=String(t.designation||t.position||"").toLowerCase().replace(/\s+/g," ").trim(),d=a.replace(/\s+/g,""),s=String(t.role||"").toLowerCase();return a==="team lead"||s==="teamlead"||d.includes("hrbplead")}).map(t=>e.jsxs("option",{value:t.email,children:[(t.firstName||"")+" "+(t.lastName||"")," (",t.email,")"]},t.email))]})]}),e.jsxs("div",{className:"form-actions",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",alignItems:"center",marginTop:12},children:[e.jsx("div",{style:{display:"flex",justifyContent:"flex-start"},children:e.jsx("button",{type:"submit",className:"btn-primary",children:u>=0?"Update":"Add"})}),e.jsx("div",{style:{display:"flex",justifyContent:"center"},children:e.jsx("button",{type:"button",className:"btn-outline",onClick:v,children:"Clear"})}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("button",{type:"button",className:"btn-danger",onClick:()=>p(!1),children:"Close"})})]})]})]})}),e.jsxs("div",{className:"dashboard-card",children:[e.jsxs("h3",{children:["Team Members (",c.length,")"]}),e.jsx("div",{className:"table-wrapper",children:e.jsxs("table",{className:"user-table",style:{minWidth:1200},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Emp ID"}),e.jsx("th",{children:"First Name"}),e.jsx("th",{children:"Last Name"}),e.jsx("th",{children:"Emp Name"}),e.jsx("th",{children:"Emp Email"}),e.jsx("th",{children:"Blood Group"}),e.jsx("th",{children:"DOB (Date of Birth)"}),e.jsx("th",{children:"Department"}),e.jsx("th",{children:"Designation"}),e.jsx("th",{children:"Employee Core Education"}),e.jsx("th",{children:"DOJ (Date of Joining)"}),e.jsx("th",{children:"Team Lead"}),e.jsx("th",{style:{textAlign:"center"},children:"Actions"})]})}),e.jsx("tbody",{children:c.length>0?c.map((t,a)=>{const d=`${t.firstName||""} ${t.lastName||""}`.trim()||t.username||"",s=m.find(f=>(f.email||"")===(t.teamLeadEmail||"")),l=s?`${s.firstName||""} ${s.lastName||""}`.trim()||s.email:t.teamLeadEmail||"â€”";return e.jsxs("tr",{children:[e.jsx("td",{children:t.empId||"â€”"}),e.jsx("td",{children:t.firstName||"â€”"}),e.jsx("td",{children:t.lastName||"â€”"}),e.jsx("td",{children:d||"â€”"}),e.jsx("td",{children:t.email}),e.jsx("td",{children:t.bloodGroup||"â€”"}),e.jsx("td",{children:E(t.dateOfBirth)}),e.jsx("td",{children:t.department||"â€”"}),e.jsx("td",{children:t.designation||t.position||"â€”"}),e.jsx("td",{children:t.coreEducation||"â€”"}),e.jsx("td",{children:E(t.dateOfJoining)}),e.jsx("td",{children:l}),e.jsx("td",{style:{textAlign:"center"},children:e.jsxs("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[e.jsx("button",{className:"btn-outline",onClick:()=>S(a),title:"Edit",children:"Edit"}),e.jsx("button",{className:"btn-danger",onClick:()=>T(a),title:"Remove",children:"Remove"})]})})]},t.email)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"13",style:{textAlign:"center"},children:'No team members found. Click "Add Team Member" to create one.'})})})]})})]})]})}export{X as default};
