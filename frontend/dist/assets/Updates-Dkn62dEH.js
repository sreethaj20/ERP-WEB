import{F as s,E as t}from"./vendor-AZjfysqh.js";import{u as D}from"./index-CcBKZM2H.js";import"./router-CieCW4vl.js";function E(){var N,z;const{currentUser:n,listUpdates:v,createUpdateApi:B,deleteUpdateApi:C}=D(),m=s.useMemo(()=>{const e=new Date;return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},[]),[f,h]=s.useState([]),[l,y]=s.useState(""),[d,S]=s.useState(m),[g,w]=s.useState(""),[o,c]=s.useState(!1),[k,x]=s.useState("");s.useEffect(()=>{let e=!0;return(async()=>{x(""),c(!0);try{const r=await v();if(!e)return;h(Array.isArray(r)?r:[])}catch(r){if(!e)return;x((r==null?void 0:r.message)||"Failed to load updates"),h([])}finally{if(!e)return;c(!1)}})(),()=>{e=!1}},[v]);const j=s.useMemo(()=>{const e=Array.isArray(f)?[...f]:[];return e.sort((a,r)=>{const p=String((a==null?void 0:a.date)||""),i=String((r==null?void 0:r.date)||"");return p!==i?i.localeCompare(p):Number((r==null?void 0:r.createdAt)||0)-Number((a==null?void 0:a.createdAt)||0)}),e},[f]),M=(n!=null&&n.firstName&&(n!=null&&n.lastName)?`${n.firstName} ${n.lastName}`.trim():(N=n==null?void 0:n.firstName)==null?void 0:N.trim())||((z=n==null?void 0:n.name)==null?void 0:z.trim())||(n!=null&&n.email?n.email.split("@")[0]:"User"),T=e=>{e.preventDefault();const a=l.trim(),r=g.trim(),p=String(d||"").trim();!a||!r||!p||(async()=>{x(""),c(!0);try{const i=await B({title:a,message:r,date:p});h(u=>[i,...Array.isArray(u)?u:[]]),y(""),w(""),S(m)}catch(i){x((i==null?void 0:i.message)||"Failed to save update")}finally{c(!1)}})()},F=e=>{(async()=>{x(""),c(!0);try{await C(e),h(a=>(Array.isArray(a)?a:[]).filter(r=>(r==null?void 0:r.id)!==e))}catch(a){x((a==null?void 0:a.message)||"Failed to delete update")}finally{c(!1)}})()};return t.jsxs("div",{className:"home-container",children:[t.jsx("div",{className:"home-title",style:{marginBottom:24,fontSize:32,fontWeight:900,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text"},children:"Updates"}),t.jsxs("div",{className:"home-card",style:{width:"100%",background:"linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%)",border:"none",boxShadow:"0 20px 40px rgba(0,0,0,0.1)"},children:[t.jsxs("div",{style:{fontWeight:800,marginBottom:20,fontSize:20,color:"#2d3748"},children:["Hello ",M," ğŸ‘‹"]}),k?t.jsx("div",{style:{marginBottom:10,color:"#b91c1c",fontWeight:700},children:k}):null,t.jsxs("form",{onSubmit:T,style:{display:"grid",gap:16,marginBottom:24,padding:"20px",background:"rgba(255,255,255,0.9)",borderRadius:16,boxShadow:"0 4px 6px rgba(0,0,0,0.05)"},children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 180px",gap:12},children:[t.jsx("input",{value:l,onChange:e=>y(e.target.value),placeholder:"âœ¨ Enter update title...",style:{height:48,borderRadius:12,border:"2px solid transparent",background:"linear-gradient(white, white) padding-box, linear-gradient(135deg, #667eea, #764ba2) border-box",padding:"0 16px",fontSize:16,fontWeight:500,transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.target.style.boxShadow="none"}}),t.jsx("input",{type:"date",value:d,onChange:e=>S(e.target.value),style:{height:48,borderRadius:12,border:"2px solid transparent",background:"linear-gradient(white, white) padding-box, linear-gradient(135deg, #667eea, #764ba2) border-box",padding:"0 16px",fontSize:16,fontWeight:500,cursor:"pointer",transition:"all 0.3s ease",outline:"none"},onFocus:e=>{e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.target.style.boxShadow="none"}})]}),t.jsx("textarea",{value:g,onChange:e=>w(e.target.value),placeholder:"ğŸ“ Write your update message...",rows:4,style:{borderRadius:12,border:"2px solid transparent",background:"linear-gradient(white, white) padding-box, linear-gradient(135deg, #667eea, #764ba2) border-box",padding:"12px 16px",resize:"vertical",fontSize:16,fontWeight:500,transition:"all 0.3s ease",outline:"none",fontFamily:"inherit"},onFocus:e=>{e.target.style.boxShadow="0 0 0 3px rgba(102, 126, 234, 0.1)"},onBlur:e=>{e.target.style.boxShadow="none"}}),t.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:12},children:[t.jsx("button",{type:"button",className:"btn-outline",onClick:()=>{y(""),w(""),S(m)},disabled:o,style:{padding:"12px 24px",borderRadius:12,border:"2px solid #e2e8f0",background:"white",color:"#64748b",fontSize:16,fontWeight:600,cursor:"pointer",transition:"all 0.3s ease"},onMouseOver:e=>{e.target.style.background="#f8fafc",e.target.style.borderColor="#cbd5e1"},onMouseOut:e=>{e.target.style.background="white",e.target.style.borderColor="#e2e8f0"},children:"Clear"}),t.jsx("button",{type:"submit",className:"btn-primary",disabled:o||!l.trim()||!g.trim()||!String(d||"").trim(),style:{padding:"12px 32px",borderRadius:12,border:"none",background:o||!l.trim()||!g.trim()||!String(d||"").trim()?"#cbd5e1":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:16,fontWeight:600,cursor:o||!l.trim()||!g.trim()||!String(d||"").trim()?"not-allowed":"pointer",transition:"all 0.3s ease",boxShadow:o||!l.trim()||!g.trim()||!String(d||"").trim()?"none":"0 4px 14px rgba(102, 126, 234, 0.4)"},onMouseOver:e=>{!o&&l.trim()&&g.trim()&&String(d||"").trim()&&(e.target.style.transform="translateY(-2px)",e.target.style.boxShadow="0 6px 20px rgba(102, 126, 234, 0.5)")},onMouseOut:e=>{!o&&l.trim()&&g.trim()&&String(d||"").trim()&&(e.target.style.transform="translateY(0)",e.target.style.boxShadow="0 4px 14px rgba(102, 126, 234, 0.4)")},children:o?"â³ Saving...":"ğŸš€ Post Update"})]})]}),o&&j.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#64748b",fontSize:18},children:[t.jsx("div",{style:{fontSize:48,marginBottom:16},children:"â³"}),t.jsx("div",{children:"Loading updates..."})]}):j.length===0?t.jsxs("div",{style:{textAlign:"center",padding:"60px 20px",color:"#64748b",fontSize:18},children:[t.jsx("div",{style:{fontSize:48,marginBottom:16},children:"ğŸ“­"}),t.jsx("div",{children:"No updates yet."}),t.jsx("div",{style:{fontSize:14,marginTop:8},children:"Create your first update above!"})]}):t.jsx("div",{style:{width:"100%",overflowX:"auto",borderRadius:16,background:"rgba(255,255,255,0.95)",boxShadow:"0 20px 40px rgba(0,0,0,0.08)",backdropFilter:"blur(10px)"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"separate",borderSpacing:0,minWidth:720},children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{style:{textAlign:"left",padding:"16px 20px",fontWeight:700,color:"white",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"none",whiteSpace:"nowrap",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px"},children:"ğŸ“… Date"}),t.jsx("th",{style:{textAlign:"left",padding:"16px 20px",fontWeight:700,color:"white",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"none",whiteSpace:"nowrap",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px"},children:"ğŸ“° Title"}),t.jsx("th",{style:{textAlign:"left",padding:"16px 20px",fontWeight:700,color:"white",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"none",whiteSpace:"nowrap",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px"},children:"ğŸ’¬ Message"}),t.jsx("th",{style:{textAlign:"right",padding:"16px 20px",fontWeight:700,color:"white",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderBottom:"none",whiteSpace:"nowrap",fontSize:14,textTransform:"uppercase",letterSpacing:"0.5px"},children:"âš¡ Action"})]})}),t.jsx("tbody",{children:j.map((e,a)=>t.jsxs("tr",{style:{background:a%2===0?"rgba(255,255,255,0.95)":"rgba(248, 250, 252, 0.95)",transition:"all 0.3s ease"},onMouseOver:r=>{r.currentTarget.style.background="rgba(237, 242, 247, 0.95)",r.currentTarget.style.transform="scale(1.01)"},onMouseOut:r=>{r.currentTarget.style.background=a%2===0?"rgba(255,255,255,0.95)":"rgba(248, 250, 252, 0.95)",r.currentTarget.style.transform="scale(1)"},children:[t.jsx("td",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(226, 232, 240, 0.5)",whiteSpace:"nowrap",fontWeight:600,color:"#475569",fontSize:14},children:(()=>{try{const r=String(e.date).trim(),[p,i,u]=r.split("-"),O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],A=parseInt(p,10),b=parseInt(i,10),W=parseInt(u,10);return isNaN(A)||isNaN(b)||isNaN(W)||b<1||b>12?e.date:`${O[b-1]} ${A}, ${W}`}catch{return e.date}})()}),t.jsx("td",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(226, 232, 240, 0.5)",fontWeight:600,color:"#1e293b",maxWidth:240,fontSize:14},title:e.title,children:t.jsxs("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:8},children:[t.jsx("span",{style:{fontSize:16},children:"ğŸ“Œ"}),e.title]})}),t.jsx("td",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(226, 232, 240, 0.5)",color:"#475569",maxWidth:520,fontSize:14,lineHeight:1.6},children:t.jsxs("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",display:"flex",alignItems:"flex-start",gap:8},children:[t.jsx("span",{style:{fontSize:16,marginTop:2},children:"ğŸ’­"}),t.jsx("span",{children:e.message})]})}),t.jsx("td",{style:{padding:"16px 20px",borderBottom:"1px solid rgba(226, 232, 240, 0.5)",textAlign:"right",whiteSpace:"nowrap"},children:t.jsxs("button",{type:"button",className:"btn-outline",disabled:o,onClick:()=>F(e.id),style:{padding:"8px 16px",borderRadius:8,border:"1.5px solid #ef4444",background:"white",color:"#ef4444",fontSize:14,fontWeight:600,cursor:o?"not-allowed":"pointer",transition:"all 0.3s ease",display:"inline-flex",alignItems:"center",gap:6},onMouseOver:r=>{o||(r.target.style.background="#ef4444",r.target.style.color="white",r.target.style.transform="scale(1.05)")},onMouseOut:r=>{o||(r.target.style.background="white",r.target.style.color="#ef4444",r.target.style.transform="scale(1)")},children:[o?"â³":"ğŸ—‘ï¸"," Delete"]})})]},e.id))})]})})]})]})}export{E as default};
