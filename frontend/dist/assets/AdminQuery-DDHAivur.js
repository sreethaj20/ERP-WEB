import{M as A,F as n,E as e}from"./vendor-AZjfysqh.js";import{u as w,b as S}from"./index-CcBKZM2H.js";import"./router-CieCW4vl.js";function B(){var y;const{currentUser:i,users:g,listMyAdminQueries:j,createAdminQuery:b}=w(),a=A(),[s,o]=n.useState({category:"policy",subject:"",description:"",priority:"normal",adminEmail:""}),[u,x]=n.useState([]),[l,h]=n.useState(!1),{addNotification:d}=S(),f=((y=i==null?void 0:i.name)==null?void 0:y.trim())||(i!=null&&i.email?i.email.split("@")[0]:"Employee"),c=async()=>{try{const t=await j(),r=Array.isArray(t)?t:[];r.sort((m,p)=>new Date(p.updatedAt||p.createdAt||p.date||0)-new Date(m.updatedAt||m.createdAt||m.date||0)),x(r)}catch{x([])}};n.useEffect(()=>{c();const t=setInterval(c,1e4);return()=>clearInterval(t)},[i==null?void 0:i.email]);const v=async t=>{if(t.preventDefault(),!s.adminEmail){d({title:"Admin Query",message:"Please select an Admin to send your query to.",type:"warning",ttl:4e3});return}try{const r=await b({category:s.category,subject:s.subject,description:s.description,priority:s.priority,adminEmail:s.adminEmail});d({title:"Admin Query Submitted",message:`Your admin query #${r.id} has been submitted.`,type:"success",link:"/employee/lcrm/admin-query",audience:`user:${((i==null?void 0:i.email)||"").toLowerCase()}`}),await c(),o({category:"policy",subject:"",description:"",priority:"normal",adminEmail:""}),h(!1)}catch(r){d({title:"Admin Query",message:(r==null?void 0:r.message)||"Failed to submit query.",type:"error",ttl:6e3})}},C=t=>{switch(t){case"submitted":return"#ffc107";case"in-progress":return"#007bff";case"resolved":return"#28a745";case"closed":return"#6c757d";default:return"#6c757d"}};return e.jsxs("div",{className:"dashboard fade-in",children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[e.jsxs("h2",{children:["âš™ï¸ Admin Query - ",f]}),e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-primary",onClick:()=>h(!l),style:{marginRight:"10px"},children:l?"Cancel":"+ Submit Query"}),String((i==null?void 0:i.role)||"").toLowerCase()==="hr"?e.jsx("button",{className:"btn btn-secondary",onClick:()=>a("/hr/solve-queries"),style:{marginRight:"8px"},children:"â†’ Move to Solve Queries"}):e.jsx("button",{className:"btn btn-secondary",onClick:()=>a("/employee/lcrm/hr-query"),style:{marginRight:"8px"},children:"â†’ Move to HR Query"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>a(-1),children:"â† Back to ICRM"})]})]}),l&&e.jsxs("div",{className:"dashboard-card",style:{marginBottom:"20px"},children:[e.jsx("h3",{children:"ðŸ“ Submit Admin Query"}),e.jsxs("form",{onSubmit:v,style:{textAlign:"left"},children:[e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Select Admin:"}),e.jsxs("select",{value:s.adminEmail,onChange:t=>o({...s,adminEmail:t.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[e.jsx("option",{value:"",children:"-- Choose Admin --"}),(g||[]).filter(t=>String(t.role||"").toLowerCase()==="admin").map(t=>e.jsx("option",{value:t.email,children:`${t.firstName||""} ${t.lastName||""}`.trim()||t.username||t.email},t.email))]})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Category:"}),e.jsxs("select",{value:s.category,onChange:t=>o({...s,category:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[e.jsx("option",{value:"policy",children:"Company Policies"}),e.jsx("option",{value:"facilities",children:"Office Facilities"}),e.jsx("option",{value:"security",children:"Security & Access"}),e.jsx("option",{value:"compliance",children:"Compliance & Legal"}),e.jsx("option",{value:"procedures",children:"Work Procedures"}),e.jsx("option",{value:"systems",children:"System Access"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Priority:"}),e.jsxs("select",{value:s.priority,onChange:t=>o({...s,priority:t.target.value}),style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Subject:"}),e.jsx("input",{type:"text",value:s.subject,onChange:t=>o({...s,subject:t.target.value}),required:!0,style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},placeholder:"Brief description of your admin query"})]}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold"},children:"Description:"}),e.jsx("textarea",{value:s.description,onChange:t=>o({...s,description:t.target.value}),required:!0,rows:"4",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #ddd"},placeholder:"Detailed description of your administrative query"})]}),e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit Query"})]})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("div",{className:"dashboard-card",style:{gridColumn:"span 2"},children:[e.jsx("h3",{children:"ðŸ“‹ My Admin Queries"}),e.jsx("div",{style:{textAlign:"left"},children:u.length===0?e.jsx("p",{children:'No queries found. Click "Submit Query" to ask your first admin question.'}):u.map(t=>e.jsxs("div",{style:{border:"1px solid #ddd",borderRadius:"8px",padding:"15px",marginBottom:"15px",backgroundColor:"#f9f9f9"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[e.jsxs("h4",{style:{margin:0,color:"#333"},children:["#",t.id," - ",t.subject]}),e.jsx("span",{style:{padding:"4px 8px",borderRadius:"4px",fontSize:"12px",fontWeight:"bold",backgroundColor:C(t.status),color:"white"},children:t.status.toUpperCase()})]}),e.jsxs("p",{style:{margin:"5px 0",color:"#666"},children:[e.jsx("strong",{children:"Category:"})," ",t.category," | ",e.jsx("strong",{children:"Date:"})," ",t.date]}),t.response&&e.jsxs("div",{style:{marginTop:"10px",padding:"10px",backgroundColor:"#e3f2fd",borderRadius:"4px",borderLeft:"4px solid #2196f3"},children:[e.jsx("strong",{children:"Admin Response:"}),e.jsx("p",{style:{margin:"5px 0 0 0"},children:t.response})]})]},t.id))})]}),e.jsxs("div",{className:"dashboard-card",children:[e.jsx("h3",{children:"ðŸ“ž Admin Contacts"}),e.jsxs("div",{style:{textAlign:"left"},children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Admin Office:"})," ext. 2000"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," admin@company.com"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Office Hours:"})," 9:00 AM - 5:30 PM"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Emergency:"})," ext. 999"]})]})]})]})]})}export{B as default};
